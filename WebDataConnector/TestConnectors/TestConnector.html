<html>
  <meta http-equiv="Cache-Control" content="no-store" />
  <head>
    <link type="text/css" rel="stylesheet" href="css/TestConnector.css"></link>
    <title>Test Web Data Connector</title>
    <script src="js/jquery-1.11.1.min.js" type="text/javascript"></script>
    <script src="../WebDataConnector_sdk/js/tableauwdc-1.1.0.js" type="text/javascript"></script>
    <script src="js/TestConnector.js" type="text/javascript"></script>
  </head>
  <body>
    <h1>Welcome to the TestConnector</h1>
    <div id="errorDiv">
      <h4 id="errorMessage"></h4>
    </div>
    <div id="autoSubmitDiv" class="statusDiv">
      <h2>
        Configured to automatically submit to Tableau in <span id="autoSubmitCountdown"></span>
      </h2>
    </div>
    <div id="manualSubmitDiv" class="statusDiv">
      <h2> Configured to manually submit the form or running in non-interactive mode</h2>
      <form id="inputForm" action="">
        Just hit the button to force submission
        <br />
        <input type="submit" value="Let's do it!">
      </form>
    </div>
    <div id="usageDiv">
      <hr>
      <h2>About The TestConnector</h2>
      <p>
        The test connector is designed to provide a simple WDC which can be configured for test purposes. The main interface for testing is to provide a URL query parameter specifying a JSON configuration file which defines the TestConnector's behavior.
      </p>
      <p>
        <strong>Usage: </strong> http://localhost:8888/TestConnector.html?configFile=<strong>{path to config file}</strong>
        <br />
        <strong>Sample: </strong> http://localhost:8888/TestConnector.html?configFile=testConfigs/basic_test.json
      </p>
      <h3>Config File Format</h3>
      <p >
        The configuration file that the TestConnector operates with has the following fields:
        <ul class="documentation">
          <li>
            <span class="fieldName">autoSubmit</span> - Whether or not the connector should automatically be submitted after delayTime when running in interactive mode. Values can be either true or false
          </li>
          <li>
            <span class="fieldName">delayTime</span> - The ammount of time (in milliseconds) to wait before autosubmitting the WDC. If autoSubmit is false, this value is ignored
          </li>
          <li>
            <span class="fieldName">fieldNames</span> - The names of the columns which will be passed back to Tableau. This array of strings will be passed as the first parameter to the tableau.headersCallback() function
          </li>
          <li>
            <span class="fieldName">fieldTypes</span> - The type of the columns which will be passed back to Tableau. This is an array of strings which will be psased as the second parameter to the tableau.headerCallback() function
          </li>
          <li>
            <span class="fieldName">connectionData</span> - This string will be assigned to the tableau.connectionData property which is then saved as a data connection attribute.
          </li>
          <li>
            <span class="fieldName">connectionName</span> - This string will be assigned to the tableau.connectionName property which is what the connection will be called in Tableau
          </li>
          <li>
            <span class="fieldName">numRows (optional)</span> - Specifies the total number of rows which will be generated by the test connector. The generated data will follow a repeatable pattern by esssentially incrementing each value to generate a new row. The increment function is different depending on the data type but is guaranteed to be determinate. Required with chunkSize.
          </li>
          <li>
            <span class="fieldName">chunkSize (optional)</span> - Specifies which size each chunk of data should be during the getTableData section of the extract creation. If this value is larger than numRows, all of the data will be returned in the first iteration of getTableData. Required with numRows.
          </li>
          <li>
            <span class="fieldName">literalData (optional)</span> - Specifies a javascript object which will be returned as the first paramter to the tableau.dataCallback() function. This can be any valid json object to facilitate error testing. Required with lastRecordToken.
          </li>
          <li>
            <span class="fieldName">lastRecordToken (optional)</span> - Specifies a javascript object which will be returned as the second paramter to the tableau.dataCallback() function. This can be any valid json object to facilitate error testing. Required with literalData.
          </li>
          <li>
            <span class="fieldName">chunkedData (optional)</span> - Specifies an array of javascript objects which will be passed back to tableau.dataCallback. Each element in the array will be passed back on subsequent calls to tableau.dataCallback. This can be useful for simulating things like a connector which passes back invalid data or a changed schema on the third or fourth iteration.
          </li>
        </ul>
      </p>
      <h4>numRows and chunkSize Sample:</h4>
      <p class="sample">
{
  "autoSubmit": false,
  "delayTime": 2000,
  "fieldNames": ["String Header", " An Int Column", "The Date", "True or False?"],
  "fieldTypes": ["string", "int", "date", "bool" ],
  "connectionData": "{BLAH, BLAH, BLAH}",
  "connectionName": "basic_test Connector",
  "numRows": 500,
  "chunkSize": 20
}
      </p>

      <h4>literalData and lastRecordToken Sample:</h4>
      <p class="sample">
{
  "autoSubmit": true,
  "delayTime": 3000,
  "fieldNames": ["Column A", "Column B"],
  "fieldTypes": ["string", "int"],
  "connectionData": "Bleepidyboop",
  "connectionName": "Wahoosie! it's a predefined data connector Connector",
  "literalData": 
  [
    { "Column A": "Value One", "Column B" : 123},
    { "Column A": "Value Two", "Column B" : 55},
    { "Column A": "The Third Value", "Column B" : 23},
    { "Column A": "Value Two", "Column B" :  11},
    { "Column A": "Value Two", "Column B" : 543}
  ],
  "lastRecordToken": "blah"
}
      </p>

      <h4>chunkedData Sample:</h4>
      <p class="sample">
{
  "autoSubmit": false,
  "delayTime": 3000,
  "fieldNames": ["Column A", "Column B"],
  "fieldTypes": ["string", "int"],
  "connectionData": "Bleepidyboop",
  "connectionName": "Yippie! Chunk that data",
  "chunkedData": 
  [
    [
      { "Column A": "Value One", "Column B" : 123},
      { "Column A": "Value Two", "Column B" : 55},
      { "Column A": "The Third Value", "Column B" : 23}
    ],
    [
      { "Column A": "Value Two", "Column B" : 543}
    ],
    [
      { "Column A": "The Third Value", "Column B" : 23},
      { "Column A": "Value Two", "Column B" :  11},
      { "Column A": "Value Two", "Column B" : 543}
    ],
    [
      { "Column A": "Value Two", "Column B" : 543}
    ],
    [
      { "Column A": "Value Two", "Column B" : 543}
    ]
  ]
}
      </p>
    </div>
  </body>
</html>